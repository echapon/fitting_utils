#ifndef tnp_weight_h
#define tnp_weight_h

#include "TMath.h"

double tnp_weight_pbpb_midrap(double x, int idx)
{
   // NOMINAL pbpb midrap
   if (idx==0) return 0.9555*TMath::Erf((x-1.3718)/2.5217) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   if (idx==-2) return 0.9555*TMath::Erf((x-1.324)/2.5683) / (0.9576*TMath::Erf((x-1.7883)/2.6583)); // old, before June 16
   if (idx==-1)  return ( 0.9988*TMath::Erf( (x-1.322)/2.688)/TMath::Erf( (x-1.796)/2.516) ); // old, from Prashant
   // variations on the pbpb midrap
   else if (idx == 1   ) return   0.9676*TMath::Erf((x-0.3392)/3.7624) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 2   ) return   0.9587*TMath::Erf((x-1.7799)/1.8728) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 3   ) return   0.9565*TMath::Erf((x-1.3377)/2.3972) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 4   ) return   0.9423*TMath::Erf((x-1.4064)/2.3246) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 5   ) return   0.9444*TMath::Erf((x-1.3209)/2.6415) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 6   ) return   0.9658*TMath::Erf((x-1.6811)/2.4426) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 7   ) return   0.9524*TMath::Erf((x-1.1478)/2.5473) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 8   ) return   0.9403*TMath::Erf((x-1.4761)/2.4603) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 9   ) return   0.9555*TMath::Erf((x-1.7397)/2.0321) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 10  ) return   0.9405*TMath::Erf((x-1.6342)/2.168) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 11  ) return   0.9467*TMath::Erf((x-1.5241)/2.4492) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 12  ) return   0.9376*TMath::Erf((x-1.8733)/1.9618) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 13  ) return   0.9506*TMath::Erf((x-1.1205)/2.7895) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 14  ) return   0.9424*TMath::Erf((x-1.7575)/1.991) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 15  ) return   0.9532*TMath::Erf((x-1.6611)/2.3944) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 16  ) return   0.949*TMath::Erf((x-1.6911)/2.0565) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 17  ) return   0.9569*TMath::Erf((x-1.6465)/2.2149) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 18  ) return   0.9486*TMath::Erf((x-0.9389)/3.1382) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 19  ) return   0.9503*TMath::Erf((x-1.6849)/2.1987) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 20  ) return   0.9506*TMath::Erf((x-1.5477)/1.9612) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 21  ) return   0.962*TMath::Erf((x-1.4683)/2.4293) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 22  ) return   0.9343*TMath::Erf((x-1.3877)/2.4019) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 23  ) return   0.9583*TMath::Erf((x-1.2145)/2.6828) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 24  ) return   0.9404*TMath::Erf((x-1.8298)/2.1498) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 25  ) return   0.955*TMath::Erf((x-1.5511)/2.3867) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 26  ) return   0.9582*TMath::Erf((x-1.3123)/2.5842) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 27  ) return   0.9404*TMath::Erf((x-0.8832)/3.0907) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 28  ) return   0.9473*TMath::Erf((x-1.4114)/2.5712) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 29  ) return   0.9573*TMath::Erf((x-1.7699)/2.1399) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 30  ) return   0.9624*TMath::Erf((x-1.8128)/1.862) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 31  ) return   0.9636*TMath::Erf((x-1.5479)/2.4586) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 32  ) return   0.9701*TMath::Erf((x-1.4972)/2.42) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 33  ) return   0.9541*TMath::Erf((x-1.7591)/1.6495) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 34  ) return   0.9457*TMath::Erf((x-1.535)/2.2384) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 35  ) return   0.9747*TMath::Erf((x-1.3633)/2.8438) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 36  ) return   0.9497*TMath::Erf((x-1.2551)/2.9144) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 37  ) return   0.9459*TMath::Erf((x-1.3503)/2.4628) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 38  ) return   0.9562*TMath::Erf((x-1.5173)/2.1837) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 39  ) return   0.9595*TMath::Erf((x-1.8053)/2.1927) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 40  ) return   0.9479*TMath::Erf((x-1.6667)/1.6725) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 41  ) return   0.9571*TMath::Erf((x-1.6638)/2.2082) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 42  ) return   0.9593*TMath::Erf((x-1.6557)/2.2337) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 43  ) return   0.9513*TMath::Erf((x-1.8743)/1.7754) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 44  ) return   0.9266*TMath::Erf((x-2.1459)/1.6548) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 45  ) return   0.9589*TMath::Erf((x-1.9353)/2.0695) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 46  ) return   0.9531*TMath::Erf((x-0.8471)/2.8791) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 47  ) return   0.9571*TMath::Erf((x-1.3031)/2.529) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 48  ) return   0.9634*TMath::Erf((x-1.3242)/2.8219) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 49  ) return   0.9658*TMath::Erf((x-1.4498)/2.6282) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 50  ) return   0.9505*TMath::Erf((x-0.9054)/2.859) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 51  ) return   0.9304*TMath::Erf((x-1.7668)/2.1442) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 52  ) return   0.9493*TMath::Erf((x-1.5753)/2.3181) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 53  ) return   0.9433*TMath::Erf((x-1.7759)/1.9924) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 54  ) return   0.9577*TMath::Erf((x-1.841)/1.9065) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 55  ) return   0.9492*TMath::Erf((x-1.6915)/2.2459) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 56  ) return   0.9532*TMath::Erf((x-1.4456)/2.3876) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 57  ) return   0.9581*TMath::Erf((x-1.8117)/2.0932) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 58  ) return   0.9577*TMath::Erf((x-0.5464)/3.2453) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 59  ) return   0.9649*TMath::Erf((x-0.9268)/2.8586) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 60  ) return   0.9667*TMath::Erf((x-1.1186)/2.7835) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 61  ) return   0.94*TMath::Erf((x-1.9251)/1.6434) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 62  ) return   0.9369*TMath::Erf((x-1.6624)/1.5633) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 63  ) return   0.9547*TMath::Erf((x-1.2871)/2.5446) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 64  ) return   0.9373*TMath::Erf((x-1.3688)/2.368) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 65  ) return   0.922*TMath::Erf((x-1.3173)/2.4831) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 66  ) return   0.9642*TMath::Erf((x-1.1623)/3.1869) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 67  ) return   0.9594*TMath::Erf((x-1.1575)/2.7995) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 68  ) return   0.9412*TMath::Erf((x-1.6409)/2.1887) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 69  ) return   0.9654*TMath::Erf((x-1.6778)/2.0459) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 70  ) return   0.9553*TMath::Erf((x-1.6501)/2.2221) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 71  ) return   0.9562*TMath::Erf((x-1.3719)/2.6974) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 72  ) return   0.9568*TMath::Erf((x-1.5847)/2.3042) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 73  ) return   0.9729*TMath::Erf((x-1.5955)/2.6559) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 74  ) return   0.953*TMath::Erf((x-1.2841)/2.5233) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 75  ) return   0.9595*TMath::Erf((x-1.6723)/2.0827) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 76  ) return   0.958*TMath::Erf((x-1.3991)/2.9849) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 77  ) return   0.9627*TMath::Erf((x-1.9968)/1.3296) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 78  ) return   0.9637*TMath::Erf((x-1.2042)/2.6292) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 79  ) return   0.9327*TMath::Erf((x-1.6787)/2.0609) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 80  ) return   0.9377*TMath::Erf((x-0.8458)/2.8854) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 81  ) return   0.9534*TMath::Erf((x-1.6648)/2.3199) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 82  ) return   0.9551*TMath::Erf((x-1.3703)/2.8103) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 83  ) return   0.9753*TMath::Erf((x-1.1125)/3.0794) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 84  ) return   0.9469*TMath::Erf((x-1.5923)/1.967) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 85  ) return   0.9524*TMath::Erf((x-1.5625)/2.4259) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 86  ) return   0.9596*TMath::Erf((x-1.8477)/1.8916) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 87  ) return   0.9484*TMath::Erf((x-1.5167)/2.1972) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 88  ) return   0.9665*TMath::Erf((x-1.4013)/2.4257) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 89  ) return   0.9563*TMath::Erf((x-1.1219)/2.7893) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 90  ) return   0.958*TMath::Erf((x-1.9621)/1.8307) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 91  ) return   0.9517*TMath::Erf((x-0.5825)/3.4696) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 92  ) return   0.9466*TMath::Erf((x-1.3413)/2.6044) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 93  ) return   0.9808*TMath::Erf((x-0.9584)/2.7052) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 94  ) return   0.9526*TMath::Erf((x-0.4553)/3.9221) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 95  ) return   0.9618*TMath::Erf((x-0.7133)/3.6024) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 96  ) return   0.9516*TMath::Erf((x-1.9548)/1.8201) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 97  ) return   0.9612*TMath::Erf((x-1.0901)/2.695) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 98  ) return   0.964*TMath::Erf((x-1.4189)/2.8789) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 99  ) return   0.9465*TMath::Erf((x-1.4031)/2.6893) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx == 100 ) return   0.9607*TMath::Erf((x-0.9364)/2.9401) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else return 1.;
}

double tnp_weight_pbpb_fwdrap(double x, int idx)
{
   // NOMINAL pbpb fwdrap
   if (idx==0) return 0.8331*TMath::Erf((x-1.3011)/1.904) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   if (idx==-2) return 0.8335*TMath::Erf((x-1.247)/1.9782) /(0.7948*TMath::Erf((x-1.3091)/2.2783)); // old, before June 16
   if (idx==-1) return (0.8299*TMath::Erf((x-1.2785)/1.8833))/(0.7810*TMath::Erf((x-1.3609)/2.1231)); // old, from Prashant
   // variations on the pbpb fwdrap
   else if (idx == 1   ) return  1.8993*TMath::Erf((x+10.79)/42.978) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 2   ) return   0.9221*TMath::Erf((x-1.4743)/1.9135) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 3   ) return   0.8764*TMath::Erf((x-1.2756)/1.8515) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 4   ) return   0.7944*TMath::Erf((x-1.5961)/1.1641) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 5   ) return   0.7772*TMath::Erf((x-1.176)/1.8851) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 6   ) return   0.9168*TMath::Erf((x-1.2815)/2.8052) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 7   ) return   0.8446*TMath::Erf((x-1.4459)/1.3662) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 8   ) return   0.7728*TMath::Erf((x-0.9695)/2.2621) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 9   ) return   0.8656*TMath::Erf((x-1.648)/1.47) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 10  ) return   0.7998*TMath::Erf((x-0.9467)/2.3917) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 11  ) return   0.7758*TMath::Erf((x-1.5819)/1.362) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 12  ) return   0.7819*TMath::Erf((x-1.5256)/1.7141) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 13  ) return   0.7871*TMath::Erf((x-1.6893)/0.9482) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 14  ) return   0.8105*TMath::Erf((x-1.5415)/1.5615) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 15  ) return   0.8525*TMath::Erf((x-0.8379)/3.1546) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 16  ) return   0.8407*TMath::Erf((x-1.5173)/1.6182) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 17  ) return   0.8665*TMath::Erf((x-1.4525)/1.8594) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 18  ) return   0.781*TMath::Erf((x-0.6059)/2.5831) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 19  ) return   0.8218*TMath::Erf((x-1.558)/1.5861) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 20  ) return   0.8834*TMath::Erf((x-1.1326)/2.0122) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 21  ) return   0.9308*TMath::Erf((x-0.5306)/3.5342) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 22  ) return   0.7523*TMath::Erf((x-1.4969)/1.2496) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 23  ) return   0.8742*TMath::Erf((x-0.8868)/2.5653) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 24  ) return   0.7775*TMath::Erf((x-1.3397)/2.1211) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 25  ) return   0.8445*TMath::Erf((x-1.3165)/2.0407) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 26  ) return   0.8871*TMath::Erf((x-0.7501)/2.8724) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 27  ) return   0.7367*TMath::Erf((x-1.3833)/1.2162) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 28  ) return   0.7613*TMath::Erf((x-1.7972)/0.8579) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 29  ) return   0.8887*TMath::Erf((x-1.3042)/2.4008) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 30  ) return   0.9482*TMath::Erf((x-1.4744)/2.0346) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 31  ) return   0.8864*TMath::Erf((x-1.3395)/2.228) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 32  ) return   0.9237*TMath::Erf((x-1.3904)/2.0877) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 33  ) return   0.9151*TMath::Erf((x-1.4704)/1.6415) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 34  ) return   0.8119*TMath::Erf((x-1.5231)/1.4349) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 35  ) return   0.978*TMath::Erf((x-0.6974)/4.0572) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 36  ) return   0.7339*TMath::Erf((x-1.7048)/0.9795) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 37  ) return   0.8172*TMath::Erf((x-0.6745)/2.5895) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 38  ) return   0.8857*TMath::Erf((x-1.3735)/1.8123) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 39  ) return   0.895*TMath::Erf((x-1.3135)/2.5571) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 40  ) return   0.8821*TMath::Erf((x-1.5517)/1.2964) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 41  ) return   0.8781*TMath::Erf((x-1.349)/2.1181) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 42  ) return   0.91*TMath::Erf((x-0.9569)/2.937) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 43  ) return   0.8838*TMath::Erf((x-1.4799)/1.9024) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 44  ) return   0.7536*TMath::Erf((x-1.4506)/2.1244) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 45  ) return   0.905*TMath::Erf((x-1.2933)/2.8285) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 46  ) return   0.8265*TMath::Erf((x-1.5943)/1.0002) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 47  ) return   0.8563*TMath::Erf((x-1.3246)/1.7755) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 48  ) return   0.9483*TMath::Erf((x+0.819)/6.167) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 49  ) return   0.9444*TMath::Erf((x-0.7938)/3.5482) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 50  ) return   0.8293*TMath::Erf((x-0.838)/2.0921) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 51  ) return   0.7334*TMath::Erf((x-1.3462)/1.8294) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 52  ) return   0.8197*TMath::Erf((x-1.3846)/1.8175) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 53  ) return   0.8226*TMath::Erf((x-1.268)/2.1047) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 54  ) return   0.9128*TMath::Erf((x-1.3969)/2.2015) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 55  ) return   0.8163*TMath::Erf((x-1.426)/1.8743) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 56  ) return   0.8623*TMath::Erf((x-0.8309)/2.6665) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 57  ) return   0.8944*TMath::Erf((x-1.3712)/2.3239) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 58  ) return   0.8854*TMath::Erf((x+0.914)/4.3681) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 59  ) return   0.9526*TMath::Erf((x+0.215)/4.1219) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 60  ) return   0.949*TMath::Erf((x-0.6003)/3.3167) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 61  ) return   0.8366*TMath::Erf((x-1.5526)/1.6298) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 62  ) return   0.8464*TMath::Erf((x-1.5326)/1.1567) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 63  ) return   0.8453*TMath::Erf((x-1.2812)/1.8033) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 64  ) return   0.7796*TMath::Erf((x-1.0849)/1.8489) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 65  ) return   0.696*TMath::Erf((x-1.2102)/1.4234) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 66  ) return   0.9536*TMath::Erf((x+0.497)/6.2559) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 67  ) return   0.8953*TMath::Erf((x-0.3376)/3.5168) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 68  ) return   0.7962*TMath::Erf((x-1.2159)/2.0306) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 69  ) return   0.9621*TMath::Erf((x-1.3229)/2.2814) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 70  ) return   0.8395*TMath::Erf((x-1.6312)/1.4451) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 71  ) return   0.7897*TMath::Erf((x-1.6221)/1.2749) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 72  ) return   0.8699*TMath::Erf((x-1.2922)/2.1451) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 73  ) return   1.0021*TMath::Erf((x-0.1923)/5.3511) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 74  ) return   0.8459*TMath::Erf((x-1.1812)/1.9395) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 75  ) return   0.9155*TMath::Erf((x-1.3241)/2.1764) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 76  ) return   0.9079*TMath::Erf((x+0.978)/6.9725) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 77  ) return   0.9494*TMath::Erf((x-1.5471)/1.705) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 78  ) return   0.8874*TMath::Erf((x-1.3266)/1.8054) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 79  ) return   0.7512*TMath::Erf((x-1.773)/0.9174) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 80  ) return   0.763*TMath::Erf((x-1.3661)/1.1662) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 81  ) return   0.8491*TMath::Erf((x-1.1854)/2.4541) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 82  ) return   0.8665*TMath::Erf((x+0.414)/5.0886) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 83  ) return   1.0153*TMath::Erf((x+0.903)/6.5745) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 84  ) return   0.8452*TMath::Erf((x-1.6354)/1.1972) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 85  ) return   0.788*TMath::Erf((x-1.7549)/1.0877) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 86  ) return   0.8943*TMath::Erf((x-1.7161)/1.4567) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 87  ) return   0.842*TMath::Erf((x-1.3059)/1.8232) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 88  ) return   0.9656*TMath::Erf((x-0.7351)/3.1876) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 89  ) return   0.8314*TMath::Erf((x-1.2377)/1.7943) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 90  ) return   0.9091*TMath::Erf((x-1.5739)/2.0185) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 91  ) return   0.8382*TMath::Erf((x+2.333)/6.249) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 92  ) return   0.792*TMath::Erf((x-1.1768)/1.9355) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 93  ) return   1.0073*TMath::Erf((x-0.3153)/3.4004) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 94  ) return   1.6268*TMath::Erf((x+12.76)/46.549) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 95  ) return   0.9266*TMath::Erf((x+1.157)/6.6425) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 96  ) return   0.8738*TMath::Erf((x-1.5258)/2.0121) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 97  ) return   0.9211*TMath::Erf((x-0.2562)/3.4094) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 98  ) return   0.9525*TMath::Erf((x+0.286)/5.8859) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 99  ) return   0.745*TMath::Erf((x-1.5895)/1.2583) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx == 100 ) return   0.914*TMath::Erf((x+0.333)/4.2251) / (0.7948*TMath::Erf((x-1.3091)/2.2783));
   else return 1.;
}

double tnp_weight_pp_midrap(double x, int idx)
{
   // NOMINAL pp midrap
   if (idx==0) return 0.9584*TMath::Erf((x-2.0359)/1.8494) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   if (idx==-2) return 0.9588*TMath::Erf((x-2.0009)/1.8998) / (0.9604*TMath::Erf((x-2.0586)/2.1567)); // old, before June 16
   if (idx==-1) return ( 0.998474*TMath::Erf( (x-1.63555)/(0.797933) ) / TMath::Erf( (x-0.222866)/(2.95593) ) ); // old, from Prashant
   // variations on the pp midrap
   else if (idx == 1   ) return 0.9612*TMath::Erf((x-1.9802)/1.9134) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 2   ) return    0.9615*TMath::Erf((x-1.9877)/1.9008) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 3   ) return    0.9567*TMath::Erf((x-2.0348)/1.8455) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 4   ) return    0.9593*TMath::Erf((x-2.0506)/1.883) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 5   ) return    0.9573*TMath::Erf((x-2.0245)/1.8364) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 6   ) return    0.9613*TMath::Erf((x-2.0562)/1.8749) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 7   ) return    0.9557*TMath::Erf((x-2.0362)/1.848) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 8   ) return    0.9564*TMath::Erf((x-2.054)/1.8585) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 9   ) return    0.9564*TMath::Erf((x-2.0397)/1.8369) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 10  ) return    0.957*TMath::Erf((x-2.0251)/1.8789) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 11  ) return    0.9558*TMath::Erf((x-2.0665)/1.7963) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 12  ) return    0.9557*TMath::Erf((x-2.0353)/1.8206) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 13  ) return    0.9593*TMath::Erf((x-2.0651)/1.8345) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 14  ) return    0.9598*TMath::Erf((x-1.9746)/1.9231) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 15  ) return    0.9578*TMath::Erf((x-2.0259)/1.8782) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 16  ) return    0.9555*TMath::Erf((x-2.0221)/1.8732) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 17  ) return    0.9592*TMath::Erf((x-2.0589)/1.834) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 18  ) return    0.9558*TMath::Erf((x-2.0459)/1.8029) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 19  ) return    0.9552*TMath::Erf((x-2.0675)/1.8144) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 20  ) return    0.9629*TMath::Erf((x-1.9998)/1.9311) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 21  ) return    0.9593*TMath::Erf((x-2.0784)/1.7999) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 22  ) return    0.9636*TMath::Erf((x-1.9999)/1.894) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 23  ) return    0.9559*TMath::Erf((x-2.0511)/1.8218) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 24  ) return    0.9559*TMath::Erf((x-2.0451)/1.8135) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 25  ) return    0.9581*TMath::Erf((x-2.013)/1.8821) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 26  ) return    0.9592*TMath::Erf((x-1.9863)/1.939) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 27  ) return    0.9548*TMath::Erf((x-2.0385)/1.7833) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 28  ) return    0.959*TMath::Erf((x-2.0066)/1.8922) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 29  ) return    0.9531*TMath::Erf((x-2.0841)/1.7453) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 30  ) return    0.9588*TMath::Erf((x-2.0107)/1.9435) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 31  ) return    0.9589*TMath::Erf((x-2.0096)/1.8646) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 32  ) return    0.9562*TMath::Erf((x-2.0225)/1.8395) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 33  ) return    0.9631*TMath::Erf((x-2.0586)/1.8485) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 34  ) return    0.9547*TMath::Erf((x-2.0341)/1.856) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 35  ) return    0.9564*TMath::Erf((x-2.0604)/1.8216) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 36  ) return    0.9612*TMath::Erf((x-2.0037)/1.9317) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 37  ) return    0.9582*TMath::Erf((x-2.0674)/1.8327) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 38  ) return    0.9597*TMath::Erf((x-2.0039)/1.9234) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 39  ) return    0.9626*TMath::Erf((x-1.9744)/1.9256) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 40  ) return    0.9611*TMath::Erf((x-2.0027)/1.8772) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 41  ) return    0.9583*TMath::Erf((x-2.0604)/1.8174) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 42  ) return    0.9608*TMath::Erf((x-2.0039)/1.9001) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 43  ) return    0.9575*TMath::Erf((x-2.0152)/1.8794) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 44  ) return    0.9565*TMath::Erf((x-2.0843)/1.8237) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 45  ) return    0.9588*TMath::Erf((x-2.0328)/1.8476) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 46  ) return    0.9632*TMath::Erf((x-2.0265)/1.9101) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 47  ) return    0.9571*TMath::Erf((x-2.0792)/1.7907) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 48  ) return    0.9587*TMath::Erf((x-2.053)/1.8478) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 49  ) return    0.9626*TMath::Erf((x-2.068)/1.847) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 50  ) return    0.9612*TMath::Erf((x-2.0154)/1.9022) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 51  ) return    0.9608*TMath::Erf((x-2.0501)/1.8886) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 52  ) return    0.9632*TMath::Erf((x-1.9291)/1.9656) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 53  ) return    0.9588*TMath::Erf((x-2.0513)/1.8575) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 54  ) return    0.9577*TMath::Erf((x-2.0509)/1.867) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 55  ) return    0.9607*TMath::Erf((x-2.0301)/1.8985) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 56  ) return    0.9608*TMath::Erf((x-2.033)/1.8387) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 57  ) return    0.9559*TMath::Erf((x-2.0822)/1.7961) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 58  ) return    0.9596*TMath::Erf((x-2.003)/1.8836) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 59  ) return    0.9611*TMath::Erf((x-2.0417)/1.8264) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 60  ) return    0.9607*TMath::Erf((x-2.0148)/1.9247) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 61  ) return    0.9593*TMath::Erf((x-1.9875)/1.924) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 62  ) return    0.9657*TMath::Erf((x-2.0516)/1.8503) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 63  ) return    0.9612*TMath::Erf((x-1.9882)/1.9607) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 64  ) return    0.9587*TMath::Erf((x-2.0581)/1.859) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 65  ) return    0.9583*TMath::Erf((x-2.0217)/1.8345) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 66  ) return    0.9553*TMath::Erf((x-2.0697)/1.8022) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 67  ) return    0.9603*TMath::Erf((x-2.0089)/1.8717) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 68  ) return    0.9577*TMath::Erf((x-2.0967)/1.7731) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 69  ) return    0.9558*TMath::Erf((x-2.0396)/1.7926) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 70  ) return    0.9628*TMath::Erf((x-1.9962)/1.9179) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 71  ) return    0.9593*TMath::Erf((x-2.0657)/1.7961) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 72  ) return    0.9575*TMath::Erf((x-2.055)/1.8344) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 73  ) return    0.9623*TMath::Erf((x-2.0376)/1.8364) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 74  ) return    0.959*TMath::Erf((x-2.0055)/1.9059) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 75  ) return    0.9597*TMath::Erf((x-1.9779)/1.9218) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 76  ) return    0.9587*TMath::Erf((x-2.0348)/1.8319) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 77  ) return    0.9569*TMath::Erf((x-2.0445)/1.8153) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 78  ) return    0.9566*TMath::Erf((x-2.0296)/1.8446) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 79  ) return    0.9583*TMath::Erf((x-2.0281)/1.8879) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 80  ) return    0.9581*TMath::Erf((x-2.0416)/1.8205) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 81  ) return    0.9587*TMath::Erf((x-2.0616)/1.8152) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 82  ) return    0.9576*TMath::Erf((x-2.0313)/1.8399) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 83  ) return    0.9579*TMath::Erf((x-2.0788)/1.799) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 84  ) return    0.9641*TMath::Erf((x-2.0166)/1.8839) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 85  ) return    0.9567*TMath::Erf((x-2.0013)/1.8973) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 86  ) return    0.9596*TMath::Erf((x-2.0576)/1.8235) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 87  ) return    0.9568*TMath::Erf((x-1.9729)/1.9079) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 88  ) return    0.9607*TMath::Erf((x-2.085)/1.8135) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 89  ) return    0.9554*TMath::Erf((x-2.0374)/1.806) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 90  ) return    0.9569*TMath::Erf((x-2.0102)/1.8848) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 91  ) return    0.9612*TMath::Erf((x-2.0086)/1.8933) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 92  ) return    0.957*TMath::Erf((x-2.0436)/1.8344) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 93  ) return    0.9574*TMath::Erf((x-2.0549)/1.8046) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 94  ) return    0.9573*TMath::Erf((x-2.0219)/1.8832) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 95  ) return    0.9586*TMath::Erf((x-2.0615)/1.8644) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 96  ) return    0.9613*TMath::Erf((x-1.9956)/1.9164) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 97  ) return    0.9605*TMath::Erf((x-2.0811)/1.7902) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 98  ) return    0.9587*TMath::Erf((x-2.0357)/1.8599) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 99  ) return    0.9556*TMath::Erf((x-1.995)/1.8665) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx == 100 ) return    0.9614*TMath::Erf((x-2.0091)/1.9045) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else return 1.;
}

double tnp_weight_pp_fwdrap(double x, int idx)
{
   // NOMINAL pp fwdrap
   if (idx==0) return 0.7813*TMath::Erf((x-0.846)/2.3254) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==-2) return 0.7897*TMath::Erf((x-0.7162)/2.6261) / (0.7364*TMath::Erf((x-1.2149)/2.3352)) ; // old, before June 16
   else if (idx==-1) return (0.7788*TMath::Erf((x-1.1903)/1.9880))/(0.7364*TMath::Erf((x-1.2538)/2.2530)); // old, from Prashant
   // variations on the pp fwdrap
   else if (idx == 1   ) return 0.7837*TMath::Erf((x-0.3197)/2.8164) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 2   ) return    0.7906*TMath::Erf((x-0.5888)/2.5868) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 3   ) return    0.7691*TMath::Erf((x-0.9964)/2.0583) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 4   ) return    0.7797*TMath::Erf((x-0.7949)/2.5432) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 5   ) return    0.7714*TMath::Erf((x-0.9596)/2.0485) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 6   ) return    0.7901*TMath::Erf((x-0.7591)/2.64) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 7   ) return    0.768*TMath::Erf((x-0.8911)/2.1709) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 8   ) return    0.763*TMath::Erf((x-0.9308)/2.2276) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 9   ) return    0.7649*TMath::Erf((x-0.9787)/2.0754) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 10  ) return    0.7683*TMath::Erf((x-0.834)/2.2695) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 11  ) return    0.7704*TMath::Erf((x-1.075)/1.9873) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 12  ) return    0.7668*TMath::Erf((x-0.9708)/2.0175) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 13  ) return    0.7858*TMath::Erf((x-0.9748)/2.2806) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 14  ) return    0.7866*TMath::Erf((x-0.6118)/2.5092) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 15  ) return    0.7718*TMath::Erf((x-0.8924)/2.2383) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 16  ) return    0.755*TMath::Erf((x-0.9308)/2.0736) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 17  ) return    0.7823*TMath::Erf((x-0.9252)/2.2921) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 18  ) return    0.7647*TMath::Erf((x-1.0009)/1.9764) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 19  ) return    0.7584*TMath::Erf((x-1.0923)/1.9708) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 20  ) return    0.8013*TMath::Erf((x-0.5809)/2.8145) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 21  ) return    0.7823*TMath::Erf((x-0.9767)/2.2437) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 22  ) return    0.8009*TMath::Erf((x-0.6981)/2.5789) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 23  ) return    0.7678*TMath::Erf((x-1.0315)/2.0224) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 24  ) return    0.7564*TMath::Erf((x-1.1112)/1.8399) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 25  ) return    0.7785*TMath::Erf((x-0.7644)/2.3671) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 26  ) return    0.7765*TMath::Erf((x-0.5832)/2.6219) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 27  ) return    0.7689*TMath::Erf((x-1.1606)/1.714) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 28  ) return    0.7809*TMath::Erf((x-0.8131)/2.3275) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 29  ) return    0.7594*TMath::Erf((x-1.1847)/1.7414) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 30  ) return    0.7784*TMath::Erf((x-0.5738)/2.7253) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 31  ) return    0.7785*TMath::Erf((x-0.8603)/2.2207) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 32  ) return    0.7701*TMath::Erf((x-1.0443)/1.9119) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 33  ) return    0.8012*TMath::Erf((x-0.8012)/2.5866) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 34  ) return    0.7526*TMath::Erf((x-0.9499)/2.0406) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 35  ) return    0.7682*TMath::Erf((x-1.0042)/2.0947) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 36  ) return    0.792*TMath::Erf((x-0.5942)/2.7366) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 37  ) return    0.7781*TMath::Erf((x-0.9773)/2.2376) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 38  ) return    0.7817*TMath::Erf((x-0.6488)/2.6134) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 39  ) return    0.7968*TMath::Erf((x-0.492)/2.735) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 40  ) return    0.7911*TMath::Erf((x-0.748)/2.4193) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 41  ) return    0.7854*TMath::Erf((x-1.0532)/2.095) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 42  ) return    0.7875*TMath::Erf((x-0.5316)/2.6762) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 43  ) return    0.772*TMath::Erf((x-0.8509)/2.2319) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 44  ) return    0.7715*TMath::Erf((x-0.9746)/2.2344) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 45  ) return    0.7758*TMath::Erf((x-0.8099)/2.3093) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 46  ) return    0.8054*TMath::Erf((x-0.6467)/2.8014) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 47  ) return    0.7742*TMath::Erf((x-1.0715)/2.0633) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 48  ) return    0.7807*TMath::Erf((x-0.936)/2.295) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 49  ) return    0.7987*TMath::Erf((x-0.7337)/2.6759) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 50  ) return    0.7927*TMath::Erf((x-0.7056)/2.5975) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 51  ) return    0.7847*TMath::Erf((x-0.6259)/2.7815) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 52  ) return    0.7967*TMath::Erf((x-0.1228)/3.0373) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 53  ) return    0.7774*TMath::Erf((x-1.0149)/2.1819) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 54  ) return    0.7744*TMath::Erf((x-0.859)/2.3721) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 55  ) return    0.7837*TMath::Erf((x-0.6293)/2.6739) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 56  ) return    0.7831*TMath::Erf((x-0.9185)/2.2355) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 57  ) return    0.7639*TMath::Erf((x-1.1033)/2.0058) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 58  ) return    0.7808*TMath::Erf((x-0.753)/2.3661) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 59  ) return    0.7941*TMath::Erf((x-0.8231)/2.3749) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 60  ) return    0.7871*TMath::Erf((x-0.6823)/2.673) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 61  ) return    0.7763*TMath::Erf((x-0.5356)/2.6279) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 62  ) return    0.8222*TMath::Erf((x-0.8469)/2.5821) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 63  ) return    0.7837*TMath::Erf((x-0.359)/2.9931) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 64  ) return    0.776*TMath::Erf((x-1.0097)/2.2351) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 65  ) return    0.7742*TMath::Erf((x-0.8291)/2.1855) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 66  ) return    0.7595*TMath::Erf((x-1.1071)/1.943) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 67  ) return    0.7833*TMath::Erf((x-0.6849)/2.4447) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 68  ) return    0.7777*TMath::Erf((x-1.1042)/2.0607) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 69  ) return    0.7658*TMath::Erf((x-0.9831)/1.9431) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 70  ) return    0.7936*TMath::Erf((x-0.4899)/2.8327) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 71  ) return    0.7897*TMath::Erf((x-1.0162)/2.1455) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 72  ) return    0.7779*TMath::Erf((x-0.8998)/2.255) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 73  ) return    0.8034*TMath::Erf((x-0.7816)/2.4932) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 74  ) return    0.7796*TMath::Erf((x-0.7334)/2.4438) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 75  ) return    0.7827*TMath::Erf((x-0.6404)/2.4951) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 76  ) return    0.7822*TMath::Erf((x-0.8908)/2.2114) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 77  ) return    0.7768*TMath::Erf((x-1.0394)/2.0032) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 78  ) return    0.7696*TMath::Erf((x-0.8978)/2.1452) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 79  ) return    0.7784*TMath::Erf((x-0.7665)/2.4384) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 80  ) return    0.7809*TMath::Erf((x-1.018)/2.052) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 81  ) return    0.7844*TMath::Erf((x-0.9674)/2.2126) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 82  ) return    0.7762*TMath::Erf((x-1.0262)/2.0206) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 83  ) return    0.7812*TMath::Erf((x-1.0772)/2.0829) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 84  ) return    0.8063*TMath::Erf((x-0.6207)/2.7269) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 85  ) return    0.7641*TMath::Erf((x-0.7756)/2.2608) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 86  ) return    0.7802*TMath::Erf((x-0.8944)/2.2962) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 87  ) return    0.7618*TMath::Erf((x-0.7061)/2.2409) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 88  ) return    0.79*TMath::Erf((x-0.9411)/2.3845) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 89  ) return    0.7652*TMath::Erf((x-1.2094)/1.6787) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 90  ) return    0.7667*TMath::Erf((x-0.8468)/2.2078) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 91  ) return    0.7868*TMath::Erf((x-0.6836)/2.5424) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 92  ) return    0.768*TMath::Erf((x-0.8974)/2.1879) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 93  ) return    0.7849*TMath::Erf((x-1.0237)/2.0662) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 94  ) return    0.771*TMath::Erf((x-0.7307)/2.391) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 95  ) return    0.7761*TMath::Erf((x-0.8818)/2.4293) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 96  ) return    0.7926*TMath::Erf((x-0.6185)/2.6348) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 97  ) return    0.7914*TMath::Erf((x-1.0303)/2.1906) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 98  ) return    0.7727*TMath::Erf((x-0.7514)/2.4293) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 99  ) return    0.7621*TMath::Erf((x-0.8889)/2.0044) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx == 100 ) return    0.7902*TMath::Erf((x-0.5352)/2.759) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else return 1.;
}

#endif //#ifndef tnp_weight_h
