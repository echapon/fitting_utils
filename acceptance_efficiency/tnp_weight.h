#ifndef tnp_weight_h
#define tnp_weight_h

#include "TMath.h"

double tnp_weight_pbpb_midrap(double x, int idx)
{
   // NOMINAL pbpb midrap
   if (idx==0) return 0.9555*TMath::Erf((x-1.324)/2.5683) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   if (idx==-1)  return ( 0.9988*TMath::Erf( (x-1.322)/2.688)/TMath::Erf( (x-1.796)/2.516) ); // old, from Prashant
   // variations on the pbpb midrap
   else if (idx==1) return 0.9632*TMath::Erf((x-1.2306)/2.7423) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==2) return 0.9563*TMath::Erf((x-1.4503)/2.3972) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==3) return 0.9547*TMath::Erf((x-1.2617)/2.583) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==4) return 0.9434*TMath::Erf((x-1.2984)/2.4904) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==5) return 0.945*TMath::Erf((x-1.3704)/2.485) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==6) return 0.9613*TMath::Erf((x-1.4113)/2.5748) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==7) return 0.9515*TMath::Erf((x-1.1591)/2.6537) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==8) return 0.9416*TMath::Erf((x-1.475)/2.3654) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==9) return 0.954*TMath::Erf((x-1.3986)/2.4664) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==10) return 0.9416*TMath::Erf((x-1.5596)/2.2526) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==11) return 0.9469*TMath::Erf((x-1.3866)/2.4856) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==12) return 0.9392*TMath::Erf((x-1.6163)/2.2029) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==13) return 0.9502*TMath::Erf((x-1.1557)/2.698) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==14) return 0.9434*TMath::Erf((x-1.5022)/2.3072) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==15) return 0.9518*TMath::Erf((x-1.533)/2.3949) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==16) return 0.9488*TMath::Erf((x-1.4384)/2.3936) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==17) return 0.9549*TMath::Erf((x-1.4085)/2.481) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==18) return 0.9485*TMath::Erf((x-1.2569)/2.634) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==19) return 0.9499*TMath::Erf((x-1.4386)/2.4348) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==20) return 0.9495*TMath::Erf((x-1.3855)/2.3833) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==21) return 0.9588*TMath::Erf((x-1.4392)/2.476) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==22) return 0.9365*TMath::Erf((x-1.3771)/2.3922) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==23) return 0.9561*TMath::Erf((x-1.2672)/2.6257) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==24) return 0.9415*TMath::Erf((x-1.6237)/2.2419) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==25) return 0.9534*TMath::Erf((x-1.3991)/2.5005) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==26) return 0.956*TMath::Erf((x-1.3232)/2.5727) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==27) return 0.9417*TMath::Erf((x-1.2219)/2.6041) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==28) return 0.9475*TMath::Erf((x-1.2658)/2.6022) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==29) return 0.9551*TMath::Erf((x-1.524)/2.3849) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==30) return 0.9589*TMath::Erf((x-1.4636)/2.4026) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==31) return 0.9596*TMath::Erf((x-1.3505)/2.5934) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==32) return 0.964*TMath::Erf((x-1.2806)/2.6575) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==33) return 0.9523*TMath::Erf((x-1.358)/2.4112) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==34  ) return 0.9462*TMath::Erf((x-1.3698)/2.45) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==35  ) return 0.9655*TMath::Erf((x-1.2845)/2.7249) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==36  ) return 0.9493*TMath::Erf((x-1.2675)/2.6472) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==37  ) return 0.9463*TMath::Erf((x-1.4168)/2.4149) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==38  ) return 0.9544*TMath::Erf((x-1.3291)/2.5115) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==39  ) return 0.957*TMath::Erf((x-1.5287)/2.4147) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==40  ) return 0.9481*TMath::Erf((x-1.2627)/2.4623) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==41  ) return 0.9551*TMath::Erf((x-1.4404)/2.4536) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==42  ) return 0.9566*TMath::Erf((x-1.5045)/2.4013) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==43  ) return 0.9501*TMath::Erf((x-1.5514)/2.2675) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==44  ) return 0.9277*TMath::Erf((x-1.8974)/1.8613) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==45  ) return 0.9561*TMath::Erf((x-1.6421)/2.3032) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==46  ) return 0.9521*TMath::Erf((x-1.0223)/2.7925) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==47  ) return 0.9551*TMath::Erf((x-1.2531)/2.6183) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==48  ) return 0.9601*TMath::Erf((x-1.4632)/2.5194) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==49  ) return 0.9613*TMath::Erf((x-1.3552)/2.6121) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==50  ) return 0.9502*TMath::Erf((x-1.1911)/2.6369) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==51  ) return 0.9332*TMath::Erf((x-1.6196)/2.1837) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==52  ) return 0.949*TMath::Erf((x-1.4227)/2.4455) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==53  ) return 0.9435*TMath::Erf((x-1.5797)/2.235) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==54  ) return 0.9551*TMath::Erf((x-1.5407)/2.3273) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==55  ) return 0.9489*TMath::Erf((x-1.4835)/2.4001) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==56  ) return 0.952*TMath::Erf((x-1.4153)/2.4493) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==57  ) return 0.9558*TMath::Erf((x-1.5325)/2.3799) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==58  ) return 0.9559*TMath::Erf((x-1.1361)/2.7292) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==59  ) return 0.9608*TMath::Erf((x-1.2099)/2.6772) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==60  ) return 0.9621*TMath::Erf((x-1.1974)/2.7219) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==61  ) return 0.9409*TMath::Erf((x-1.5892)/2.1675) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==62  ) return 0.9386*TMath::Erf((x-1.2931)/2.3498) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==63  ) return 0.9532*TMath::Erf((x-1.2657)/2.5966) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==64  ) return 0.9391*TMath::Erf((x-1.4082)/2.3657) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==65  ) return 0.9256*TMath::Erf((x-1.4729)/2.2443) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==66  ) return 0.9598*TMath::Erf((x-1.316)/2.6945) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==67  ) return 0.957*TMath::Erf((x-1.2815)/2.6315) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==68  ) return 0.9421*TMath::Erf((x-1.5155)/2.3055) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==69  ) return 0.9609*TMath::Erf((x-1.4003)/2.4833) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==70  ) return 0.9538*TMath::Erf((x-1.375)/2.5114) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==71  ) return 0.9544*TMath::Erf((x-1.2791)/2.6465) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==72  ) return 0.9548*TMath::Erf((x-1.4078)/2.4869) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==73  ) return 0.9651*TMath::Erf((x-1.4952)/2.5387) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==74  ) return 0.9519*TMath::Erf((x-1.2839)/2.5663) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==75  ) return 0.9569*TMath::Erf((x-1.4299)/2.4435) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==76  ) return 0.9558*TMath::Erf((x-1.4668)/2.5427) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==77  ) return 0.9564*TMath::Erf((x-1.485)/2.2664) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==78  ) return 0.9598*TMath::Erf((x-1.1737)/2.7153) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==79  ) return 0.9353*TMath::Erf((x-1.4267)/2.3341) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==80  ) return 0.9396*TMath::Erf((x-1.1942)/2.5657) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==81  ) return 0.9521*TMath::Erf((x-1.4924)/2.4189) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==82  ) return 0.9536*TMath::Erf((x-1.4619)/2.4981) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==83  ) return 0.966*TMath::Erf((x-1.3006)/2.7048) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==84  ) return 0.9474*TMath::Erf((x-1.2928)/2.4794) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==85  ) return 0.9515*TMath::Erf((x-1.3288)/2.5685) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==86  ) return 0.9574*TMath::Erf((x-1.415)/2.4649) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==87  ) return 0.9482*TMath::Erf((x-1.3883)/2.4261) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==88  ) return 0.9618*TMath::Erf((x-1.3345)/2.5718) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==89  ) return 0.9545*TMath::Erf((x-1.2098)/2.6733) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==90  ) return 0.9558*TMath::Erf((x-1.5868)/2.3041) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==91  ) return 0.9512*TMath::Erf((x-1.2145)/2.6835) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==92  ) return 0.9468*TMath::Erf((x-1.3652)/2.4957) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==93  ) return 0.9667*TMath::Erf((x-1.1436)/2.7286) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==94  ) return 0.9513*TMath::Erf((x-1.242)/2.7069) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==95  ) return 0.9583*TMath::Erf((x-1.1665)/2.8127) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==96  ) return 0.9505*TMath::Erf((x-1.6225)/2.2372) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==97  ) return 0.9585*TMath::Erf((x-1.2565)/2.6215) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==98  ) return 0.9599*TMath::Erf((x-1.428)/2.5866) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==99  ) return 0.9468*TMath::Erf((x-1.3529)/2.5424) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else if (idx==100 ) return 0.9582*TMath::Erf((x-1.2334)/2.6655) / (0.9576*TMath::Erf((x-1.7883)/2.6583));
   else return 1.;
}

double tnp_weight_pbpb_fwdrap(double x, int idx)
{
   // NOMINAL pbpb fwdrap
   if (idx==0) return 0.8335*TMath::Erf((x-1.247)/1.9782) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   if (idx==-1) return (0.8299*TMath::Erf((x-1.2785)/1.8833))/(0.7810*TMath::Erf((x-1.3609)/2.1231)); // old, from Prashant
   // variations on the pbpb fwdrap
   else if (idx==1   ) return 1.04*TMath::Erf((x-1.3676)/1.9868) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==2   ) return 0.8874*TMath::Erf((x-1.2919)/1.7771) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==3   ) return 0.8503*TMath::Erf((x-1.5344)/1.3019) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==4   ) return 0.8043*TMath::Erf((x-1.3039)/1.6251) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==5   ) return 0.7744*TMath::Erf((x-1.5606)/1.6849) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==6   ) return 0.8356*TMath::Erf((x-1.4199)/1.4217) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==7   ) return 0.8299*TMath::Erf((x-1.1044)/1.991) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==8   ) return 0.7818*TMath::Erf((x-1.5913)/1.5087) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==9   ) return 0.8446*TMath::Erf((x-0.9177)/2.449) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==10  ) return 0.8272*TMath::Erf((x-1.5643)/1.3432) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==11  ) return 0.7773*TMath::Erf((x-1.47)/1.7564) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==12  ) return 0.8041*TMath::Erf((x-1.6313)/1.0645) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==13  ) return 0.7894*TMath::Erf((x-1.4815)/1.6482) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==14  ) return 0.8216*TMath::Erf((x-0.9093)/2.652) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==15  ) return 0.8226*TMath::Erf((x-1.463)/1.6672) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==16  ) return 0.8349*TMath::Erf((x-1.4449)/1.752) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==17  ) return 0.8426*TMath::Erf((x-1.189)/1.623) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==18  ) return 0.7643*TMath::Erf((x-1.5328)/1.5462) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==19  ) return 0.8114*TMath::Erf((x-1.0312)/2.2342) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==20  ) return 0.8848*TMath::Erf((x-0.3038)/3.6587) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==21  ) return 0.9057*TMath::Erf((x-1.4608)/1.3652) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==22  ) return 0.7779*TMath::Erf((x-1.1312)/2.0201) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==23  ) return 0.8396*TMath::Erf((x-1.3385)/1.9457) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==24  ) return 0.7853*TMath::Erf((x-1.374)/1.7936) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==25  ) return 0.8235*TMath::Erf((x-0.99)/2.3035) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==26  ) return 0.8484*TMath::Erf((x-1.4586)/1.1401) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==27  ) return 0.746*TMath::Erf((x-1.7454)/0.9487) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==28  ) return 0.7679*TMath::Erf((x-1.2835)/2.1888) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==29  ) return 0.8545*TMath::Erf((x-1.3601)/2.0907) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==30  ) return 0.9032*TMath::Erf((x-1.4603)/1.7528) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==31  ) return 0.846*TMath::Erf((x-1.4371)/1.8302) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==32  ) return 0.8845*TMath::Erf((x-1.3576)/1.8525) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==33  ) return 0.9016*TMath::Erf((x-1.48)/1.5002) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==34  ) return 0.814*TMath::Erf((x-1.3167)/2.0443) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==35  ) return 0.8578*TMath::Erf((x-1.6747)/1.0217) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==36  ) return 0.7472*TMath::Erf((x-0.7763)/2.4475) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==37  ) return 0.8249*TMath::Erf((x-1.3409)/1.7979) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==38  ) return 0.858*TMath::Erf((x-1.376)/2.0968) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==39  ) return 0.849*TMath::Erf((x-1.4559)/1.5173) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==40  ) return 0.877*TMath::Erf((x-1.3645)/1.9229) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==41  ) return 0.8475*TMath::Erf((x-0.7778)/2.9863) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==42  ) return 0.8845*TMath::Erf((x-1.34)/2.085) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==43  ) return 0.8792*TMath::Erf((x-1.2849)/2.3966) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==44  ) return 0.8278*TMath::Erf((x-1.0976)/2.7914) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==45  ) return 0.8734*TMath::Erf((x-1.5317)/1.1456) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==46  ) return 0.8192*TMath::Erf((x-1.3466)/1.6921) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==47  ) return 0.8381*TMath::Erf((x+1.0221)/5.9572) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==48  ) return 0.9272*TMath::Erf((x-1.1456)/2.3537) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==49  ) return 0.8642*TMath::Erf((x-1.0547)/1.8239) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==50  ) return 0.8167*TMath::Erf((x-1.3435)/1.7963) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==51  ) return 0.7683*TMath::Erf((x-1.404)/1.687) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==52  ) return 0.808*TMath::Erf((x-1.1709)/2.2249) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==53  ) return 0.8409*TMath::Erf((x-1.2298)/2.3374) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==54  ) return 0.8889*TMath::Erf((x-1.4465)/1.6989) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==55  ) return 0.8031*TMath::Erf((x-0.8523)/2.5157) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==56  ) return 0.8476*TMath::Erf((x-1.3536)/2.1098) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==57  ) return 0.8575*TMath::Erf((x+0.0173)/3.1926) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==58  ) return 0.8536*TMath::Erf((x+0.1444)/3.9524) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==59  ) return 0.9205*TMath::Erf((x-0.9828)/2.3826) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==60  ) return 0.8842*TMath::Erf((x-1.445)/1.8373) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==61  ) return 0.8573*TMath::Erf((x-1.414)/1.4839) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==62  ) return 0.867*TMath::Erf((x-1.3194)/1.6987) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==63  ) return 0.8292*TMath::Erf((x-1.1255)/1.881) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==64  ) return 0.8048*TMath::Erf((x-1.2569)/1.5195) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==65  ) return 0.7479*TMath::Erf((x+0.1528)/4.8231) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==66  ) return 0.8965*TMath::Erf((x-0.8161)/2.5066) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==67  ) return 0.8466*TMath::Erf((x-1.2007)/2.0195) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==68  ) return 0.8123*TMath::Erf((x-1.2431)/2.261) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==69  ) return 0.9119*TMath::Erf((x-1.5839)/1.4746) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==70  ) return 0.828*TMath::Erf((x-1.5848)/1.3165) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==71  ) return 0.7927*TMath::Erf((x-1.3346)/1.9108) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==72  ) return 0.8414*TMath::Erf((x+0.1317)/5.517) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==73  ) return 0.9845*TMath::Erf((x-1.2494)/1.7846) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==74  ) return 0.8278*TMath::Erf((x-1.2557)/2.1384) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==75  ) return 0.8784*TMath::Erf((x+0.4332)/5.1134) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==76  ) return 0.8549*TMath::Erf((x-1.4214)/2.0101) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==77  ) return 0.9571*TMath::Erf((x-1.3481)/1.7219) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==78  ) return 0.8628*TMath::Erf((x-1.6945)/1.1093) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==79  ) return 0.7798*TMath::Erf((x-1.3584)/1.2879) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==80  ) return 0.7813*TMath::Erf((x-1.2849)/2.0297) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==81  ) return 0.8196*TMath::Erf((x+0.1872)/4.1939) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==82  ) return 0.8373*TMath::Erf((x+0.8115)/6.2015) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==83  ) return 0.9966*TMath::Erf((x-1.5534)/1.3692) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==84  ) return 0.8434*TMath::Erf((x-1.698)/1.1746) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==85  ) return 0.7908*TMath::Erf((x-1.6499)/1.5109) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==86  ) return 0.8657*TMath::Erf((x-1.2721)/1.8624) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==87  ) return 0.8394*TMath::Erf((x-0.6828)/3.1061) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==88  ) return 0.923*TMath::Erf((x-1.3132)/1.6448) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==89  ) return 0.8198*TMath::Erf((x-1.4696)/2.0121) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==90  ) return 0.8739*TMath::Erf((x-0.0008)/3.02) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==91  ) return 0.7941*TMath::Erf((x-1.2968)/1.6717) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==92  ) return 0.7847*TMath::Erf((x+0.0236)/4.0371) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==93  ) return 0.9859*TMath::Erf((x+2.188)/6.1701) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==94  ) return 0.8068*TMath::Erf((x-1.1445)/1.7629) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==95  ) return 0.7797*TMath::Erf((x-1.387)/2.1233) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==96  ) return 0.8662*TMath::Erf((x-0.3946)/3.095) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==97  ) return 0.8862*TMath::Erf((x+0.131)/4.9483) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==98  ) return 0.9081*TMath::Erf((x-1.5839)/1.2297) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else if (idx==99  ) return 0.7536*TMath::Erf((x-0.0755)/3.4974) /(0.7948*TMath::Erf((x-1.3091)/2.2783));
   else return 1.;
}

double tnp_weight_pp_midrap(double x, int idx)
{
   // NOMINAL pp midrap
   if (idx==0) return 0.9588*TMath::Erf((x-2.0009)/1.8998) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   if (idx==-1) return ( 0.998474*TMath::Erf( (x-1.63555)/(0.797933) ) / TMath::Erf( (x-0.222866)/(2.95593) ) ); // old, from Prashant
   // variations on the pp midrap
   else if (idx==1   ) return 0.9615*TMath::Erf((x-1.9636)/1.9542) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==2   ) return 0.9618*TMath::Erf((x-1.9621)/1.9488) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==3   ) return 0.9576*TMath::Erf((x-1.9917)/1.9064) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==4   ) return 0.9596*TMath::Erf((x-2.0045)/1.9303) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==5   ) return 0.9583*TMath::Erf((x-1.9856)/1.9036) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==6   ) return 0.9612*TMath::Erf((x-2.0129)/1.9211) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==7   ) return 0.9564*TMath::Erf((x-2.0077)/1.8885) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==8   ) return 0.9572*TMath::Erf((x-2.0084)/1.909) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==9   ) return 0.9572*TMath::Erf((x-1.9934)/1.9038) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==10  ) return 0.9575*TMath::Erf((x-1.9945)/1.9163) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==11  ) return 0.9568*TMath::Erf((x-2.0224)/1.8621) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==12  ) return 0.9566*TMath::Erf((x-1.9998)/1.8827) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==13  ) return 0.9598*TMath::Erf((x-2.0173)/1.893) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==14  ) return 0.9601*TMath::Erf((x-1.9591)/1.9492) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==15  ) return 0.9584*TMath::Erf((x-1.9858)/1.9266) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==16  ) return 0.9564*TMath::Erf((x-1.9827)/1.9226) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==17  ) return 0.9597*TMath::Erf((x-2.0153)/1.8925) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==18  ) return 0.9567*TMath::Erf((x-2.0074)/1.8725) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==19  ) return 0.9562*TMath::Erf((x-2.013)/1.8847) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==20  ) return 0.9627*TMath::Erf((x-1.9658)/1.9674) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==21  ) return 0.9598*TMath::Erf((x-2.0299)/1.8704) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==22  ) return 0.9631*TMath::Erf((x-1.963)/1.9487) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==23  ) return 0.9569*TMath::Erf((x-2.0073)/1.8852) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==24  ) return 0.9566*TMath::Erf((x-1.9899)/1.8958) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==25  ) return 0.9586*TMath::Erf((x-1.9859)/1.9212) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==26  ) return 0.9595*TMath::Erf((x-1.9549)/1.9743) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==27  ) return 0.9564*TMath::Erf((x-1.9988)/1.8631) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==28  ) return 0.9595*TMath::Erf((x-1.9738)/1.936) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==29  ) return 0.9542*TMath::Erf((x-2.0459)/1.8135) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==30  ) return 0.9589*TMath::Erf((x-1.9869)/1.9495) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==31  ) return 0.9596*TMath::Erf((x-1.9706)/1.9288) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==32  ) return 0.9575*TMath::Erf((x-1.9924)/1.8895) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==33  ) return 0.963*TMath::Erf((x-2.0163)/1.9046) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==34  ) return 0.9558*TMath::Erf((x-1.9958)/1.9072) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==35  ) return 0.9573*TMath::Erf((x-2.0166)/1.8821) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==36  ) return 0.9611*TMath::Erf((x-1.9766)/1.9569) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==37  ) return 0.9588*TMath::Erf((x-2.022)/1.8881) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==38  ) return 0.9598*TMath::Erf((x-1.9703)/1.9574) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==39  ) return 0.9627*TMath::Erf((x-1.9525)/1.9656) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==40  ) return 0.9615*TMath::Erf((x-1.9691)/1.9349) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==41  ) return 0.959*TMath::Erf((x-2.021)/1.8703) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==42  ) return 0.9609*TMath::Erf((x-1.9833)/1.9346) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==43  ) return 0.9582*TMath::Erf((x-1.983)/1.9233) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==44  ) return 0.9565*TMath::Erf((x-2.0422)/1.8635) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==45  ) return 0.9594*TMath::Erf((x-1.9983)/1.9047) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==46  ) return 0.9628*TMath::Erf((x-1.9936)/1.9422) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==47  ) return 0.9579*TMath::Erf((x-2.0285)/1.8631) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==48  ) return 0.9593*TMath::Erf((x-2.0049)/1.9069) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==49  ) return 0.9622*TMath::Erf((x-2.0297)/1.8946) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==50  ) return 0.9614*TMath::Erf((x-1.9799)/1.9444) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==51  ) return 0.9607*TMath::Erf((x-2.0108)/1.9298) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==52  ) return 0.9632*TMath::Erf((x-1.919)/2.001) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==53  ) return 0.9594*TMath::Erf((x-2.0004)/1.9144) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==54  ) return 0.9581*TMath::Erf((x-2.0132)/1.9054) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==55  ) return 0.9607*TMath::Erf((x-1.9994)/1.9315) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==56  ) return 0.9615*TMath::Erf((x-1.98)/1.9217) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==57  ) return 0.9564*TMath::Erf((x-2.0285)/1.865) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==58  ) return 0.9602*TMath::Erf((x-1.9701)/1.9374) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==59  ) return 0.9614*TMath::Erf((x-2.0098)/1.8842) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==60  ) return 0.9608*TMath::Erf((x-1.9718)/1.9674) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==61  ) return 0.9595*TMath::Erf((x-1.9627)/1.958) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==62  ) return 0.9637*TMath::Erf((x-2.0227)/1.8808) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==63  ) return 0.9609*TMath::Erf((x-1.9604)/1.9854) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==64  ) return 0.9593*TMath::Erf((x-2.0014)/1.9187) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==65  ) return 0.9591*TMath::Erf((x-1.9926)/1.8951) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==66  ) return 0.9561*TMath::Erf((x-2.0154)/1.8751) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==67  ) return 0.9607*TMath::Erf((x-1.9811)/1.9236) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==68  ) return 0.9585*TMath::Erf((x-2.0477)/1.843) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==69  ) return 0.9567*TMath::Erf((x-2.0079)/1.8605) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==70  ) return 0.9628*TMath::Erf((x-1.9631)/1.9669) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==71  ) return 0.9599*TMath::Erf((x-2.0254)/1.86) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==72  ) return 0.9581*TMath::Erf((x-2.024)/1.8766) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==73  ) return 0.9625*TMath::Erf((x-2.0037)/1.8953) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==74  ) return 0.9594*TMath::Erf((x-1.9745)/1.9434) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==75  ) return 0.9601*TMath::Erf((x-1.9504)/1.9639) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==76  ) return 0.9593*TMath::Erf((x-2.0022)/1.8878) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==77  ) return 0.9577*TMath::Erf((x-2.0073)/1.8739) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==78  ) return 0.9575*TMath::Erf((x-1.9959)/1.8991) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==79  ) return 0.9584*TMath::Erf((x-2.001)/1.9159) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==80  ) return 0.959*TMath::Erf((x-2.0026)/1.883) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==81  ) return 0.9593*TMath::Erf((x-2.021)/1.8744) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==82  ) return 0.9585*TMath::Erf((x-1.9914)/1.8989) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==83  ) return 0.9587*TMath::Erf((x-2.0357)/1.8566) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==84  ) return 0.964*TMath::Erf((x-1.9858)/1.9333) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==85  ) return 0.9575*TMath::Erf((x-1.9719)/1.9381) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==86  ) return 0.9602*TMath::Erf((x-2.0139)/1.8899) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==87  ) return 0.9577*TMath::Erf((x-1.9455)/1.958) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==88  ) return 0.9609*TMath::Erf((x-2.0376)/1.8746) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==89  ) return 0.9567*TMath::Erf((x-1.9902)/1.8824) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==90  ) return 0.9576*TMath::Erf((x-1.9759)/1.9316) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==91  ) return 0.9615*TMath::Erf((x-1.9732)/1.945) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==92  ) return 0.9573*TMath::Erf((x-2.0054)/1.8916) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==93  ) return 0.9582*TMath::Erf((x-2.0225)/1.8585) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==94  ) return 0.9579*TMath::Erf((x-1.9959)/1.9176) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==95  ) return 0.959*TMath::Erf((x-2.0089)/1.921) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==96  ) return 0.9614*TMath::Erf((x-1.9686)/1.9526) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==97  ) return 0.961*TMath::Erf((x-2.0358)/1.8573) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==98  ) return 0.9588*TMath::Erf((x-1.9972)/1.9147) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==99  ) return 0.9562*TMath::Erf((x-1.9719)/1.9116) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else if (idx==100 ) return 0.9614*TMath::Erf((x-1.9817)/1.9423) / (0.9604*TMath::Erf((x-2.0586)/2.1567));
   else return 1.;
}

double tnp_weight_pp_fwdrap(double x, int idx)
{
   // NOMINAL pp fwdrap
   if (idx==0) return 0.7897*TMath::Erf((x-0.7162)/2.6261) / (0.7364*TMath::Erf((x-1.2149)/2.3352)) ;
   if (idx==-1) return (0.7788*TMath::Erf((x-1.1903)/1.9880))/(0.7364*TMath::Erf((x-1.2538)/2.2530)); // old, from Prashant
      // variations on the pp fwdrap
   else if (idx==1   ) return 0.7942*TMath::Erf((x-0.4544)/2.9516) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==2   ) return 0.7966*TMath::Erf((x-0.6032)/2.7645) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==3   ) return 0.7798*TMath::Erf((x-0.8401)/2.4172) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==4   ) return 0.7859*TMath::Erf((x-0.7205)/2.7117) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==5   ) return 0.7832*TMath::Erf((x-0.8115)/2.4312) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==6   ) return 0.7956*TMath::Erf((x-0.6919)/2.8066) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==7   ) return 0.7788*TMath::Erf((x-0.7591)/2.5448) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==8   ) return 0.7765*TMath::Erf((x-0.7898)/2.5472) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==9   ) return 0.777*TMath::Erf((x-0.837)/2.407) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==10  ) return 0.7789*TMath::Erf((x-0.7194)/2.604) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==11  ) return 0.7805*TMath::Erf((x-0.9023)/2.3651) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==12  ) return 0.7789*TMath::Erf((x-0.8185)/2.4155) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==13  ) return 0.7914*TMath::Erf((x-0.847)/2.5349) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==14  ) return 0.7925*TMath::Erf((x-0.5944)/2.7624) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==15  ) return 0.7806*TMath::Erf((x-0.7701)/2.536) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==16  ) return 0.7702*TMath::Erf((x-0.7737)/2.462) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==17  ) return 0.7902*TMath::Erf((x-0.8085)/2.564) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==18  ) return 0.7784*TMath::Erf((x-0.8386)/2.3895) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==19  ) return 0.7727*TMath::Erf((x-0.9148)/2.3294) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==20  ) return 0.8018*TMath::Erf((x-0.5926)/2.8829) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==21  ) return 0.7896*TMath::Erf((x-0.8583)/2.4978) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==22  ) return 0.8031*TMath::Erf((x-0.6815)/2.7031) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==23  ) return 0.7786*TMath::Erf((x-0.8677)/2.3906) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==24  ) return 0.7719*TMath::Erf((x-0.917)/2.2468) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==25  ) return 0.7867*TMath::Erf((x-0.6896)/2.6539) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==26  ) return 0.7844*TMath::Erf((x-0.5825)/2.7816) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==27  ) return 0.7798*TMath::Erf((x-0.9296)/2.2284) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==28  ) return 0.7873*TMath::Erf((x-0.7226)/2.6003) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==29  ) return 0.7747*TMath::Erf((x-0.9603)/2.2483) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==30  ) return 0.7866*TMath::Erf((x-0.5437)/2.9455) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==31  ) return 0.7865*TMath::Erf((x-0.7685)/2.4954) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==32  ) return 0.7787*TMath::Erf((x-0.8541)/2.3573) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==33  ) return 0.8039*TMath::Erf((x-0.7361)/2.7476) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==34  ) return 0.7695*TMath::Erf((x-0.7814)/2.4647) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==35  ) return 0.7806*TMath::Erf((x-0.8472)/2.4559) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==36  ) return 0.7966*TMath::Erf((x-0.5799)/2.8982) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==37  ) return 0.7872*TMath::Erf((x-0.8376)/2.5353) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==38  ) return 0.7879*TMath::Erf((x-0.6231)/2.7753) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==39  ) return 0.8016*TMath::Erf((x-0.5433)/2.8701) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==40  ) return 0.7949*TMath::Erf((x-0.7079)/2.6189) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==41  ) return 0.7894*TMath::Erf((x-0.893)/2.4307) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==42  ) return 0.7956*TMath::Erf((x-0.5577)/2.8775) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==43  ) return 0.782*TMath::Erf((x-0.7322)/2.5716) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==44  ) return 0.7808*TMath::Erf((x-0.8279)/2.5652) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==45  ) return 0.7871*TMath::Erf((x-0.7248)/2.6085) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==46  ) return 0.8055*TMath::Erf((x-0.6216)/2.9188) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==47  ) return 0.7832*TMath::Erf((x-0.916)/2.3794) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==48  ) return 0.7872*TMath::Erf((x-0.8231)/2.5294) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==49  ) return 0.8044*TMath::Erf((x-0.6858)/2.8531) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==50  ) return 0.7964*TMath::Erf((x-0.666)/2.7615) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==51  ) return 0.7921*TMath::Erf((x-0.6095)/2.9075) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==52  ) return 0.8011*TMath::Erf((x-0.3726)/3.0238) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==53  ) return 0.7832*TMath::Erf((x-0.8718)/2.4481) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==54  ) return 0.7835*TMath::Erf((x-0.7474)/2.6483) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==55  ) return 0.7937*TMath::Erf((x-0.6)/2.8837) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==56  ) return 0.791*TMath::Erf((x-0.825)/2.4581) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==57  ) return 0.7757*TMath::Erf((x-0.9356)/2.3322) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==58  ) return 0.7897*TMath::Erf((x-0.6909)/2.6294) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==59  ) return 0.7994*TMath::Erf((x-0.7516)/2.628) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==60  ) return 0.7908*TMath::Erf((x-0.6484)/2.7854) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==61  ) return 0.7866*TMath::Erf((x-0.5554)/2.8157) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==62  ) return 0.8152*TMath::Erf((x-0.7789)/2.723) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==63  ) return 0.7918*TMath::Erf((x-0.4469)/3.0451) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==64  ) return 0.7828*TMath::Erf((x-0.8743)/2.462) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==65  ) return 0.7871*TMath::Erf((x-0.7297)/2.5545) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==66  ) return 0.7732*TMath::Erf((x-0.9305)/2.2984) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==67  ) return 0.7928*TMath::Erf((x-0.6522)/2.7012) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==68  ) return 0.7876*TMath::Erf((x-0.9336)/2.4072) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==69  ) return 0.7797*TMath::Erf((x-0.8225)/2.3886) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==70  ) return 0.7983*TMath::Erf((x-0.5467)/2.8949) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==71  ) return 0.7944*TMath::Erf((x-0.878)/2.4573) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==72  ) return 0.788*TMath::Erf((x-0.7725)/2.6065) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==73  ) return 0.8037*TMath::Erf((x-0.7396)/2.6649) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==74  ) return 0.7867*TMath::Erf((x-0.6698)/2.6874) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==75  ) return 0.7893*TMath::Erf((x-0.6255)/2.6999) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==76  ) return 0.7901*TMath::Erf((x-0.7801)/2.535) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==77  ) return 0.7841*TMath::Erf((x-0.8768)/2.3778) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==78  ) return 0.7812*TMath::Erf((x-0.7699)/2.5104) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==79  ) return 0.785*TMath::Erf((x-0.6868)/2.7038) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==80  ) return 0.7892*TMath::Erf((x-0.8596)/2.4225) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==81  ) return 0.7909*TMath::Erf((x-0.839)/2.5107) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==82  ) return 0.7835*TMath::Erf((x-0.8663)/2.3813) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==83  ) return 0.7911*TMath::Erf((x-0.9008)/2.456) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==84  ) return 0.8088*TMath::Erf((x-0.6241)/2.8559) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==85  ) return 0.777*TMath::Erf((x-0.6762)/2.6079) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==86  ) return 0.7899*TMath::Erf((x-0.7922)/2.563) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==87  ) return 0.7765*TMath::Erf((x-0.6383)/2.5836) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==88  ) return 0.7949*TMath::Erf((x-0.831)/2.6018) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==89  ) return 0.777*TMath::Erf((x-0.9595)/2.1955) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==90  ) return 0.7777*TMath::Erf((x-0.7318)/2.5402) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==91  ) return 0.794*TMath::Erf((x-0.6535)/2.7288) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==92  ) return 0.7796*TMath::Erf((x-0.7826)/2.5058) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==93  ) return 0.7905*TMath::Erf((x-0.8625)/2.4496) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==94  ) return 0.7834*TMath::Erf((x-0.6556)/2.7144) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==95  ) return 0.7842*TMath::Erf((x-0.7799)/2.6256) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==96  ) return 0.7972*TMath::Erf((x-0.6096)/2.8091) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==97  ) return 0.7979*TMath::Erf((x-0.8866)/2.4947) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==98  ) return 0.7832*TMath::Erf((x-0.6966)/2.6505) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==99  ) return 0.7743*TMath::Erf((x-0.7472)/2.44) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else if (idx==100 ) return 0.7947*TMath::Erf((x-0.5715)/2.8694) / (0.7364*TMath::Erf((x-1.2149)/2.3352));
   else return 1.;
}

#endif //#ifndef tnp_weight_h
